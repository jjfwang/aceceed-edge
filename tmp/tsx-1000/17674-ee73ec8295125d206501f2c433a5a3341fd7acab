{"code":"var __defProp=Object.defineProperty;var __name=(target,value)=>__defProp(target,\"name\",{value,configurable:true});const defaultTimeoutMs=3e3;class VisionOcr{constructor(config,logger){this.config=config;this.logger=logger}static{__name(this,\"VisionOcr\")}async run(image){if(!this.config?.enabled){return null}if(this.config.mockText){return this.config.mockText}if(!this.config.serviceUrl){this.logger.warn(\"OCR is enabled but no serviceUrl is configured.\");return null}const controller=new AbortController;const timer=setTimeout(()=>controller.abort(),this.config.timeoutMs??defaultTimeoutMs);try{const response=await fetch(this.config.serviceUrl,{method:\"POST\",headers:{\"Content-Type\":\"application/octet-stream\"},body:image,signal:controller.signal});if(!response.ok){this.logger.warn({status:response.status},\"OCR service returned non-200\");return null}const data=await response.json();return data.text??null}catch(err){this.logger.warn({err},\"OCR request failed\");return null}finally{clearTimeout(timer)}}}export{VisionOcr};\n","warnings":[],"map":{"version":3,"mappings":"kHAGA,MAAM,iBAAmB,IAElB,MAAM,SAAU,CACrB,YAAoB,OAAqC,OAAgB,CAArD,mBAAqC,kBAAiB,CAN5E,MAKuB,0BAGrB,MAAM,IAAI,MAAuC,CAC/C,GAAI,CAAC,KAAK,QAAQ,QAAS,CACzB,OAAO,IACT,CAEA,GAAI,KAAK,OAAO,SAAU,CACxB,OAAO,KAAK,OAAO,QACrB,CAEA,GAAI,CAAC,KAAK,OAAO,WAAY,CAC3B,KAAK,OAAO,KAAK,iDAAiD,EAClE,OAAO,IACT,CAEA,MAAM,WAAa,IAAI,gBACvB,MAAM,MAAQ,WAAW,IAAM,WAAW,MAAM,EAAG,KAAK,OAAO,WAAa,gBAAgB,EAE5F,GAAI,CACF,MAAM,SAAW,MAAM,MAAM,KAAK,OAAO,WAAY,CACnD,OAAQ,OACR,QAAS,CAAE,eAAgB,0BAA2B,EACtD,KAAM,MACN,OAAQ,WAAW,MACrB,CAAC,EAED,GAAI,CAAC,SAAS,GAAI,CAChB,KAAK,OAAO,KAAK,CAAE,OAAQ,SAAS,MAAO,EAAG,8BAA8B,EAC5E,OAAO,IACT,CAEA,MAAM,KAAQ,MAAM,SAAS,KAAK,EAClC,OAAO,KAAK,MAAQ,IACtB,OAAS,IAAK,CACZ,KAAK,OAAO,KAAK,CAAE,GAAI,EAAG,oBAAoB,EAC9C,OAAO,IACT,QAAE,CACA,aAAa,KAAK,CACpB,CACF,CACF","names":[],"ignoreList":[],"sources":["/home/pi/aceceed-edge/apps/src/vision/ocr.ts"],"sourcesContent":[null]}}