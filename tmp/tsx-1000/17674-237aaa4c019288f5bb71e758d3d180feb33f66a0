{"code":"var __defProp=Object.defineProperty;var __name=(target,value)=>__defProp(target,\"name\",{value,configurable:true});import{promises as fs}from\"node:fs\";import path from\"node:path\";import YAML from\"yaml\";import{configSchema}from\"@aceceed/shared\";const defaultConfigCandidates=[path.resolve(process.cwd(),\"configs/config.yaml\"),path.resolve(process.cwd(),\"../configs/config.yaml\")];async function resolveConfigPath(){const explicit=process.env.ACECEED_CONFIG;if(explicit){return path.resolve(explicit)}for(const candidate of defaultConfigCandidates){try{await fs.access(candidate);return candidate}catch{continue}}throw new Error(\"Config file not found. Set ACECEED_CONFIG or add configs/config.yaml.\")}__name(resolveConfigPath,\"resolveConfigPath\");function applyEnvOverrides(config){const env=process.env;if(env.ACECEED_LLM_MODE){config.llm.mode=env.ACECEED_LLM_MODE}if(env.ACECEED_LLM_CLOUD_MODEL){config.llm.cloud.model=env.ACECEED_LLM_CLOUD_MODEL}if(env.ACECEED_LLM_CLOUD_BASEURL){config.llm.cloud.baseUrl=env.ACECEED_LLM_CLOUD_BASEURL}if(env.ACECEED_LLM_CLOUD_TEMPERATURE){const parsed=Number(env.ACECEED_LLM_CLOUD_TEMPERATURE);if(!Number.isNaN(parsed)){config.llm.cloud.temperature=parsed}}if(env.ACECEED_LLM_LOCAL_BACKEND){config.llm.local.backend=env.ACECEED_LLM_LOCAL_BACKEND}if(env.ACECEED_LLAMA_SERVER_URL){config.llm.local.llamaServerUrl=env.ACECEED_LLAMA_SERVER_URL}if(env.ACECEED_LLAMA_MODEL_PATH){config.llm.local.modelPath=env.ACECEED_LLAMA_MODEL_PATH}if(env.ACECEED_LLM8850_HOST){config.llm.local.llm8850={...config.llm.local.llm8850??{host:env.ACECEED_LLM8850_HOST},host:env.ACECEED_LLM8850_HOST}}if(env.ACECEED_STT_BIN){config.stt.whispercpp.binPath=env.ACECEED_STT_BIN}if(env.ACECEED_STT_MODEL){config.stt.whispercpp.modelPath=env.ACECEED_STT_MODEL}if(env.ACECEED_STT_LANGUAGE){config.stt.whispercpp.language=env.ACECEED_STT_LANGUAGE}if(env.ACECEED_TTS_BIN){config.tts.piper.binPath=env.ACECEED_TTS_BIN}if(env.ACECEED_TTS_VOICE){config.tts.piper.voicePath=env.ACECEED_TTS_VOICE}if(env.ACECEED_VISION_BACKEND){config.vision.capture.backend=env.ACECEED_VISION_BACKEND}if(env.ACECEED_API_PORT){config.api.port=Number(env.ACECEED_API_PORT)}if(env.ACECEED_AUDIO_DEVICE){config.audio.input.device=env.ACECEED_AUDIO_DEVICE;config.audio.output.device=env.ACECEED_AUDIO_DEVICE}if(env.ACECEED_LOG_LEVEL){config.logging.level=env.ACECEED_LOG_LEVEL}if(env.ACECEED_RAG_INDEX){config.rag.indexPath=env.ACECEED_RAG_INDEX}if(env.ACECEED_RAG_GRADE){config.rag.gradeBand=env.ACECEED_RAG_GRADE}if(env.ACECEED_RAG_SUBJECTS){config.rag.subjects=env.ACECEED_RAG_SUBJECTS.split(\",\").map(s=>s.trim()).filter(Boolean)}return config}__name(applyEnvOverrides,\"applyEnvOverrides\");async function loadConfig(){const configPath=await resolveConfigPath();const raw=await fs.readFile(configPath,\"utf-8\");const parsed=YAML.parse(raw);const withEnv=applyEnvOverrides(parsed);return configSchema.parse(withEnv)}__name(loadConfig,\"loadConfig\");export{loadConfig};\n","warnings":[],"map":{"version":3,"mappings":"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","names":[],"ignoreList":[],"sources":["/home/pi/aceceed-edge/apps/src/common/config.ts"],"sourcesContent":[null]}}